# 设备排期系统

这是一个基于Web的设备排期系统，可以通过上传Excel文件来进行设备排期规划。系统使用遗传算法进行排期优化，支持多设备类型匹配、紧急度计算和负载均衡。

## 功能特点

- 支持同时上传设备数据和委托数据文件
- 智能数据解析与清洗
- 基于遗传算法的智能排期
- 设备负载均衡与任务迁移
- 甘特图与表格形式的结果展示
- 多维度筛选与查询功能

## 数据准备

系统支持上传两个独立的Excel文件：

### 委托数据文件

委托数据文件需要包含以下列：

| 委托单号 | 设备类别 | 测试时长(小时) | 收样日期 | 要求完成时间 |
|---------|---------|--------------|---------|------------|
| SH202304110 | 高温设备 | 48 | 2023-01-05 | 2023-01-20 |
| SH202304109 | 低温设备 | 72 | 2023-01-12 | 2023-01-25 |

### 设备数据文件

设备数据文件需要包含以下列：

| 设备编号 | 设备类别 | 历史负载率 |
|---------|---------|-----------|
| QLTC-KF-A-0223 | 高温设备 | 0.45 |
| QLTC-KF-A-0225 | 低温设备 | 0.35 |

数据文件中只需包含相关字段即可，系统会自动解析和处理数据。

## 排期规则说明

1. **时间窗口约束**
   - 计划开始时间 ≥ max(收样日期, 排期系统当前时间)
   - 计划完成时间 ≤ 要求完成时间
   - 单次测试时长需满足：测试时长 ≤ (要求完成时间 - 计划开始时间)

2. **冲突解决机制**
   - 若设备时间窗冲突，按「CR值（紧急比率）」动态调整优先级：
   - CR = (要求完成时间 - 当前日期) / 测试时长（CR越小越优先）
   - 设备负载超过80%时触发任务迁移，匹配同类设备中负载率<50%的替代设备

## 使用方法

1. 准备符合上述格式的Excel文件
2. 上传步骤：
   - 点击"选择设备数据文件"按钮选择设备数据文件
   - 点击"选择委托数据文件"按钮选择委托数据文件
   - 点击"上传并处理"按钮开始排期计算
3. 在结果页面查看甘特图或表格形式的排期结果
4. 使用筛选功能按设备编号、委托单号、设备类型或时间范围进行筛选

## 状态说明

排期结果中的状态字段说明：

- **已排期**：正常排期完成的任务
- **已迁移**：由于设备负载过高被迁移到其他设备的任务
- **超出截止日期**：无法在要求完成时间前完成的任务
- **时间悖论错误**：收样日期晚于要求完成时间的异常任务
- **无匹配设备**：没有找到匹配设备类别的任务

## 本地开发与部署

1. 克隆项目到本地
2. 在浏览器中打开`index.html`文件即可使用
3. 如需后台存储功能，请自行实现服务器端代码 